CREATE TABLE ROL (
	ID INT NOT NULL,
	Descripcion VARCHAR(50) NOT NULL,
	Activo INT NOT NULL,
	PRIMARY KEY(ID)

);

CREATE TABLE COMPANIA (
	ID INT NOT NULL,
	Nombre VARCHAR(30) NOT NULL,
	Activo INT NOT NULL,
	PRIMARY KEY(ID)
);

CREATE TABLE SUCURSAL (
	ID SERIAL PRIMARY KEY NOT NULL,
	CedAdmin INT,
  IDCompania INT,
	Nombre VARCHAR(30) NOT NULL,
	Descripcion VARCHAR(30) NOT NULL,
	Provincia VARCHAR(50) NOT NULL,
	Canton VARCHAR(50) NOT NULL,
	Distrito VARCHAR(50) NOT NULL,
	Indicaciones VARCHAR(120) NOT NULL,
	Activo INT NOT NULL
);

CREATE TABLE EMPLEADO(
	Cedula INT NOT NULL,
	FNacimiento DATE NOT NULL,
	Contraseña VARCHAR(20) NOT NULL,
	Nombre1 VARCHAR(20) NOT NULL,
	Nombre2 VARCHAR(20),
	Apellido1 VARCHAR(20) NOT NULL,
	Apellido2 VARCHAR(20) NOT NULL,
	Provincia VARCHAR(50) NOT NULL,
	Canton VARCHAR(50) NOT NULL,
	Distrito VARCHAR(50) NOT NULL,
	Indicaciones VARCHAR(120) NOT NULL,
	Telefono INT,
	IDCompania INT,
	IDSucursal INT,
	Activo INT NOT NULL,
	PRIMARY KEY (Cedula)

);

CREATE TABLE ROL_EMPLEADO (
	IDRol INT,
	CedulaEmpleado INT,
	Activo INT NOT NULL,
  PRIMARY KEY (CedulaEmpleado,IDRol,Activo)
);



CREATE TABLE CLIENTE(
	Cedula INT NOT NULL,
	FNacimiento DATE NOT NULL,
	Nombre1 VARCHAR(20) NOT NULL,
	Nombre2 VARCHAR(20),
	Apellido1 VARCHAR(20) NOT NULL,
	Apellido2 VARCHAR(20) NOT NULL,
	Provincia VARCHAR(50) NOT NULL,
	Canton VARCHAR(50) NOT NULL,
	Distrito VARCHAR(50) NOT NULL,
	Indicaciones VARCHAR(120) NOT NULL,
	Telefono INT,
	Activo INT NOT NULL,
	PRIMARY KEY (Cedula,Activo)
);

CREATE TABLE MEDICAMENTO (
	EAN VARCHAR(30) NOT NULL,
	CasaFarmaceutica VARCHAR(30) NOT NULL,
	Prescripcion INT NOT NULL,
	CantidadTotal VARCHAR(30) NOT NULL,
	IDCompania INT,
	Activo INT NOT NULL,
	PRIMARY KEY(EAN)
);

CREATE TABLE SUC_MEDICAMENTO (
	EANMedicamento VARCHAR(30),
	IDSucursal INT,
	Cantidad INT NOT NULL,
	Activo INT NOT NULL,
  PRIMARY KEY (EANMedicamento,IDSucursal,Activo)
);


CREATE TABLE VENTA(
	ID SERIAL PRIMARY KEY,
	NumCaja INT NOT NULL,
	CedCliente INT,
	Fecha DATE,
	TipoPago VARCHAR(50),
	Activo INT NOT NULL
);

CREATE TABLE CONT_VENTA(
	ID SERIAL PRIMARY KEY,
	IDVenta INT,
	EANMedicamento VARCHAR(30),
	PrecioTotal INT,
	Cantidad INT,
	Activo INT NOT NULL
);

CREATE TABLE APERTURA_CAJA(
	ID varchar(max),
	NumCaja INT NOT NULL,
	CedCajero INT NOT NULL,
  Hora TIME NOT NULL,
	Fecha DATE NOT NULL,
	Dinero INT NOT NULL,
	Activo INT NOT NULL,
	PRIMARY KEY (ID)
);

CREATE TABLE CIERRE_CAJA(
	ID SERIAL PRIMARY KEY,
	IDApertura ID varchar(max),
	VentaEfectivo INT,
	VentaTarjeta INT,
	DineroTotal INT,
	Activo INT NOT NULL
);

CREATE TABLE PROVEEDOR (
	ID INT NOT NULL,
    Nombre VARCHAR(50),
    Activo INT,
    PRIMARY KEY(ID)
);

CREATE TABLE MEDICAMENTO_PROVEEDOR (
	  ID SERIAL NOT NULL,
    EANMedicamento VARCHAR(30),
    IDProveedor INT,
    Activo INT,
    PRIMARY KEY(ID)
);



ALTER TABLE CIERRE_CAJA
ADD CONSTRAINT APERTURAxCIERRE FOREIGN KEY (IDApertura) REFERENCES APERTURA_CAJA (ID);

ALTER TABLE APERTURA_CAJA
ADD CONSTRAINT EMPLEADOxAPERTURA FOREIGN KEY (CedCajero) REFERENCES EMPLEADO(Cedula);

ALTER TABLE CONT_VENTA
ADD CONSTRAINT VENTAxCONT_VENTA FOREIGN KEY (IDVenta) REFERENCES VENTA(ID);

ALTER TABLE CONT_VENTA
ADD CONSTRAINT MEDICAMENTOxCONT_VENTA FOREIGN KEY (EANMedicamento) REFERENCES MEDICAMENTO(EAN);

ALTER TABLE VENTA
ADD CONSTRAINT CLIENTExVENTA FOREIGN KEY (CedCliente) REFERENCES CLIENTE(Cedula);

ALTER TABLE MEDICAMENTO
ADD CONSTRAINT COMPANIAxMEDICAMENTO FOREIGN KEY (IDCompania) REFERENCES COMPANIA(ID);

ALTER TABLE SUC_MEDICAMENTO
ADD CONSTRAINT MEDICAMENTOxSUC_MEDICAMENTO FOREIGN KEY (EANMedicamento) REFERENCES MEDICAMENTO(EAN);

ALTER TABLE SUC_MEDICAMENTO
ADD CONSTRAINT SUCURSALxSUC_MEDICMANENTO FOREIGN KEY (IDSucursal) REFERENCES SUCURSAL(ID);

ALTER TABLE ROL_EMPLEADO
ADD CONSTRAINT ROLxROL_EMPLEADO FOREIGN KEY (IDRol) REFERENCES ROL(ID);

ALTER TABLE ROL_EMPLEADO
ADD CONSTRAINT EMPLEADOxROL_EMPLEADO FOREIGN KEY (CedulaEmpleado) REFERENCES EMPLEADO(CEDULA);

ALTER TABLE EMPLEADO
ADD CONSTRAINT COMPANIAxEMPLEADO FOREIGN KEY (IDCompania) REFERENCES COMPANIA(ID);

ALTER TABLE EMPLEADO
ADD CONSTRAINT SUCURSALxEMPLEADO FOREIGN KEY (IDSucursal) REFERENCES SUCURSAL(ID);

ALTER TABLE SUCURSAL
ADD CONSTRAINT COMPANIAxSUCURSAL FOREIGN KEY (IDCompañia) REFERENCES COMPANIA(ID);

ALTER TABLE SUCURSAL
ADD CONSTRAINT EMPLEADOxSUCURSAL FOREIGN KEY (CedAdmin) REFERENCES EMPLEADO(Cedula);

ALTER TABLE MEDICAMENTO_PROVEEDOR
ADD CONSTRAINT PROVEEDORxMEDICAMENTO_PROVEEDOR FOREIGN KEY (IDProveedor) REFERENCES PROVEEDOR(ID);

ALTER TABLE MEDICAMENTO_PROVEEDOR
ADD CONSTRAINT MEDICAMENTOxMEDICAMENTO_PROVEEDOR FOREIGN KEY (EANMedicamento) REFERENCES MEDICAMENTO(EAN);
